{% extends "base/base.html" %}

{% load static %}

{% block content %}

<section class="section-content padding-y bg">
    <div class="container">

        <!-- ============================ COMPONENT 2 ================================= -->
        <div class="row">
            <main class="col-md-8">

                <article class="card mb-4">
                    <div class="card-body">
                        <h4 class="card-title mb-4">Review cart</h4>
                        <div class="row">
                            {% for cart_item in cart_items %}
                            <div class="col-md-6">
                                <figure class="itemside  mb-4">
                                    <div class="aside"><img src="{{ cart_item.product_variant.product.image.url }}"
                                            class="border img-sm"></div>
                                    <figcaption class="info">
                                        <p>
                                            {{ cart_item.product_variant.product.name }} -
                                            {{ cart_item.product_variant.color.name }} -
                                            {{ cart_item.product_variant.size.name }}
                                        </p>
                                        <span class="text-muted">
                                            {{ cart_item.quantity }} x ${{ cart_item.product_variant.price }} =
                                            ${{ cart_item.price }}
                                        </span>
                                    </figcaption>
                                </figure>
                            </div> <!-- col.// -->
                            {% empty %}
                            <div class="col-md-12">
                                <p class="alert alert-warning">Your cart is empty</p>
                            </div>
                            {% endfor %}

                        </div> <!-- row.// -->
                    </div> <!-- card-body.// -->
                </article> <!-- card.// -->


                <article class="card mb-4">
                    <div class="card-body">
                        <h4 class="card-title mb-4">Delivery info</h4>
                        <form method="post" action="{% url 'checkout' %}">


                            <div class="row">
                                <div class="form-group col-sm-6">
                                    <label>Region</label>
                                    <select class="mr-2 form-control" name="region" onchange="getDistrictByRegion()">

                                        <option value="{{profile.region.id}}" selected>{{profile.region}}</option>
    
                                        {% for region in regions %}
                                            <option value="{{region.id}}">{{region}}</option>
                                        {% empty %}
                                            <option>No region</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="form-group col-sm-6">
                                    <label>District*</label>                                
                                    <select class="mr-2 form-control" name="district">

                                        <option value="{{profile.district.id}}" selected>{{profile.district}}</option>
                                        
                                        {% for district in districts %}
                                            <option value="{{district.id}}">{{district}}</option>
                                        {% empty %}
                                        <option>No district</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="form-group col-sm-6">
                                    <label>Street*</label>
                                    <input name="street" type="text" placeholder="Type here" class="form-control">
                                </div>
                                <div class="form-group col-sm-4">
                                    <label>Building</label>
                                    <input name="building" type="text" placeholder="" class="form-control">
                                </div>
                                <div class="form-group col-sm-6">
                                    <label>House</label>
                                    <input name="house" type="text" placeholder="Type here" class="form-control">
                                </div>
                                <div class="form-group col-sm-6">
                                    <label>Postal code</label>
                                    <input name="postal_code" type="text" placeholder="" class="form-control">
                                </div>
                                <div class="form-group col-sm-6">
                                    <label>Phone</label>
                                    <input name="phone" type="text" class="form-control" placeholder="+998 "
                                        value="{{user_profile.phone}}">
                                </div>
                                <div class="form-group col-sm-6">
                                    <label>Email</label>
                                    <input name="email" type="email" placeholder="example@gmail.com" class="form-control"
                                        value="{{user_profile.email}}">
                                </div>
                            </div> <!-- row.// -->
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary btn-block"> Save </button>
                                <a href="{% url 'payment' %}" class="btn btn-light btn-block">Pay</a>
                            </div>
                        </form>
                    </div> <!-- card-body.// -->
                </article> <!-- card.// -->



            </main> <!-- col.// -->

            <aside class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <dl class="dlist-align">
                            <dt>Total price:</dt>
                            <dd class="text-right">${{grand_total}}</dd>
                        </dl>
                        <dl class="dlist-align">
                            <dt>Donation:</dt>
                            <dd class="text-right"> ${{donation}} </dd>
                        </dl>
                        <dl class="dlist-align">
                            <dt>Total:</dt>
                            <dd class="text-right text-dark b"><strong>${{total_price}}</strong></dd>
                        </dl>
                        <hr>
                        <p class="text-center mb-3">
                            <img src="{% static './images/misc/payments.png' %}" height="26">
                        </p>

                    </div> <!-- card-body.// -->
                </div> <!-- card.// -->
            </aside> <!-- col.// -->
        </div> <!-- row.// -->

        <!-- ============================ COMPONENT 2 END//  ================================= -->

    </div> <!-- container .//  -->
</section>
<!-- ========================= SECTION CONTENT END// ========================= -->

{% endblock content %}